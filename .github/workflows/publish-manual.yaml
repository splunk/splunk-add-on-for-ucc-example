name: test-workflow
on: 
  workflow_dispatch:
    inputs:
      testtype:
        description: 'Test type'     
        required: true
        default: 'knowledge' 
        type: choice
        options:
        - knowledge
        - ui
        - modinput
      splunkversion:
        required: true
      tags:
        description: 'Test scenario tags'
        required: false 
        type: boolean
      
jobs:
  log-the-inputs:
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "Test type: $TYPE"
          echo "Tags: $TAGS"
          echo "Splunk version: $VERSION"
        env:
          TYPE: ${{ inputs.testtype }}
          TAGS: ${{ inputs.tags }}
          VERSION: ${{ inputs.splunkversion }}
          
  call-workflow:
    uses: splunk/addonfactory-workflow-addon-release/.github/workflows/reusable-build-test-release.yml@v1.7
    secrets:
      GH_TOKEN_ADMIN: ${{ secrets.GH_TOKEN_ADMIN }}
      GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      SEMGREP_PUBLISH_TOKEN: ${{ secrets.SEMGREP_PUBLISH_TOKEN }}
      AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
      AWS_DEFAULT_REGION: ${{ secrets.AWS_DEFAULT_REGION }}
      AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
      VT_API_KEY: ${{ secrets.VT_API_KEY }}
      CODECOV_TOKEN: ${{ secrets.CODECOV_TOKEN }}
      OTHER_TA_REQUIRED_CONFIGS: ${{ secrets.OTHER_TA_REQUIRED_CONFIGS }}
      FOSSA_API_KEY: ${{ secrets.FOSSA_API_KEY }}
